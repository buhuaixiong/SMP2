import{d as e,u as t,c as l,b as a,e as n,y as s,t as o,f as i,x as p,F as c,r as u,S as r,aa as m,o as d,_ as g}from"./index-CyQdnTIC.js";const y={complete:"Complete",mostly_complete:"Mostly complete",needs_attention:"Needs attention"},b={class:"supplier-list"},h={class:"list-toolbar"},S={class:"results-count"},v={key:0},k={key:1},f={key:2,class:"selection-count"},I={key:0,class:"pagination-bar"},x=["value"],C=["value"],P={class:"pager-buttons"},_=["disabled"],$=["disabled"],w={key:0,class:"panel"},z={key:1,class:"panel empty-state"},E={key:2,class:"panel"},D={class:"supplier-table"},M={class:"checkbox-column"},N=["checked","indeterminate"],q={class:"checkbox-column"},G=["checked","onChange"],O={class:"company-cell"},T={class:"company-name"},j={class:"company-meta"},A={class:"company-meta"},B={class:"completion-cell"},F=["title"],L={class:"completion-score"},R={class:"actions-cell"},U=["onClick"],H=["onClick"],J={key:0,class:"detail-row"},K={colspan:"7"},Q=g(e({__name:"SupplierTable",props:{suppliers:{},loading:{type:Boolean},pageStart:{},pageEnd:{},totalItems:{},pageSize:{},pageSizeOptions:{},currentPage:{},totalPages:{},canGoPrevious:{type:Boolean},canGoNext:{type:Boolean},selectedSupplierId:{},expandedSupplierId:{},selectedSupplierIds:{}},emits:["update:pageSize","previous-page","next-page","select","toggle-expand","update:selectedSupplierIds"],setup(e,{emit:g}){const{t:Q}=t(),V=e,W=g,{completionLabel:X,completionPillClass:Y,completionTooltip:Z}={completionLabel:e=>{const t=e.completionStatus??e.complianceSummary?.completionCategory;return t?y[t]??t:"Unknown"},completionPillClass:e=>{const t=e.completionStatus??e.complianceSummary?.completionCategory;return{"pill-complete":"complete"===t,"pill-mostly":"mostly_complete"===t,"pill-attention":"complete"!==t&&"mostly_complete"!==t}},completionTooltip:e=>{const t=Math.round(e.profileCompletion??e.complianceSummary?.profileScore??0),l=Math.round(e.documentCompletion??e.complianceSummary?.documentScore??0),a=new Set,n=e=>{if(!e)return;const t=String(e).trim();t&&a.add(t)};Array.isArray(e.missingRequirements)&&e.missingRequirements.forEach(e=>{e&&("string"!=typeof e?(n(e.label),n(e.key)):n(e))});const s=e.complianceSummary;s&&(s.missingItems?.forEach(e=>n(e?.label??e?.key)),s.missingDocumentTypes?.forEach(e=>n(e?.label??e?.type)),s.missingProfileFields?.forEach(e=>n(e?.label??e?.key)));const o=[`Profile completion: ${t}%`,`Document completion: ${l}%`];return a.size?o.push(`Outstanding requirements: ${Array.from(a).join(", ")}`):o.push("Outstanding requirements: none"),o.join("\n")}},ee=l(()=>V.selectedSupplierIds||[]),te=e=>ee.value.includes(e),le=l(()=>0!==V.suppliers.length&&V.suppliers.every(e=>te(e.id))),ae=l(()=>{const e=V.suppliers.filter(e=>te(e.id)).length;return e>0&&e<V.suppliers.length}),ne=()=>{if(le.value){const e=V.suppliers.map(e=>e.id),t=ee.value.filter(t=>!e.includes(t));W("update:selectedSupplierIds",t)}else{const e=V.suppliers.map(e=>e.id),t=[...new Set([...ee.value,...e])];W("update:selectedSupplierIds",t)}},se=e=>{const t=Number(e.target.value);W("update:pageSize",t)};return(t,l)=>(d(),a("section",b,[n("header",h,[n("div",S,[e.totalItems>0?(d(),a("span",v,o(i(Q)("table.showing",{start:e.pageStart,end:e.pageEnd,total:e.totalItems})),1)):(d(),a("span",k,o(i(Q)("table.noMatch")),1)),ee.value.length>0?(d(),a("span",f," · "+o(ee.value.length)+" selected ",1)):s("",!0)]),e.totalItems?(d(),a("div",I,[n("label",null,[p(o(i(Q)("table.perPage"))+" ",1),n("select",{value:e.pageSize,onChange:se},[(d(!0),a(c,null,u(e.pageSizeOptions,e=>(d(),a("option",{key:e,value:e},o(e),9,C))),128))],40,x)]),n("div",P,[n("button",{type:"button",disabled:!e.canGoPrevious,onClick:l[0]||(l[0]=e=>t.$emit("previous-page"))},o(i(Q)("common.previous")),9,_),n("span",null,o(i(Q)("table.page",{current:e.currentPage,total:e.totalPages})),1),n("button",{type:"button",disabled:!e.canGoNext,onClick:l[1]||(l[1]=e=>t.$emit("next-page"))},o(i(Q)("common.next")),9,$)])])):s("",!0)]),e.loading?(d(),a("div",w,o(i(Q)("table.loading")),1)):e.suppliers.length?(d(),a("div",E,[n("table",D,[n("thead",null,[n("tr",null,[n("th",M,[n("input",{type:"checkbox",checked:le.value,indeterminate:ae.value,onChange:ne,title:"Select all on this page"},null,40,N)]),n("th",null,o(i(Q)("table.columns.company")),1),n("th",null,o(i(Q)("table.columns.category")),1),n("th",null,o(i(Q)("table.columns.region")),1),n("th",null,o(i(Q)("table.columns.importance")),1),n("th",null,o(i(Q)("table.columns.completion")),1),l[2]||(l[2]=n("th",null,null,-1))])]),n("tbody",null,[(d(!0),a(c,null,u(e.suppliers,l=>(d(),a(c,{key:l.id},[n("tr",{class:r({active:l.id===e.selectedSupplierId,selected:te(l.id)})},[n("td",q,[n("input",{type:"checkbox",checked:te(l.id),onChange:e=>(e=>{const t=te(e)?ee.value.filter(t=>t!==e):[...ee.value,e];W("update:selectedSupplierIds",t)})(l.id)},null,40,G)]),n("td",null,[n("div",O,[n("span",T,o(l.companyName),1),n("span",j,o(l.companyId),1),n("span",A,o(l.contactPerson)+" · "+o(l.contactEmail),1)])]),n("td",null,o(l.category||"–"),1),n("td",null,o(l.region||"–"),1),n("td",null,o(l.importance||"–"),1),n("td",B,[n("div",{class:"completion-summary",title:i(Z)(l)},[n("span",L,o(Math.round(l.completionScore??0))+"%",1),n("span",{class:r(["completion-pill",i(Y)(l)])},o(i(X)(l)),3)],8,F)]),n("td",R,[n("button",{class:"icon-btn",type:"button",onClick:e=>t.$emit("toggle-expand",l.id)},o(e.expandedSupplierId===l.id?i(Q)("table.hideDetails"):i(Q)("table.showDetails")),9,U),n("button",{class:"link-btn",type:"button",onClick:e=>t.$emit("select",l.id)},o(i(Q)("common.view")),9,H)])],2),e.expandedSupplierId===l.id?(d(),a("tr",J,[n("td",K,[m(t.$slots,"details",{supplier:l},void 0,!0)])])):s("",!0)],64))),128))])])])):(d(),a("div",z,o(i(Q)("table.noData")),1))]))}}),[["__scopeId","data-v-2115a954"]]);export{Q as default};
