import{d as e,u as r,h as t,i as a,b as l,j as o,k as s,f as i,x as m,t as n,e as u,E as p,A as c,o as f,_ as d}from"./index-CyQdnTIC.js";import{E as b}from"./el-card-DJj_OhI8.js";import{E as q,a as g}from"./el-form-item-DJ87vTOW.js";/* empty css                 */import{E as _,a as y}from"./el-descriptions-item-C3lsVx1m.js";import{E as h}from"./el-tag-eQgnjs1v.js";import{E as j}from"./el-alert-BXhB-eTB.js";import{o as v}from"./rfq-M3h8wC6E.js";import{u as x}from"./useNotification-DAUqvaBw.js";import"./castArray-C2ko8TfK.js";import"./_baseClone-CxGxK45k.js";const N={class:"pr-fill-form"},w={class:"highlight-amount"},E={class:"form-actions"},D=d(e({__name:"PRFillForm",props:{rfqId:{},rfq:{},selectedQuote:{}},emits:["submitted","cancel"],setup(e,{emit:d}){const D=x(),R=e,S=d,{t:k}=r(),I=t(),C=t(!1);t([]);const F=a({prNumber:"",prDate:(new Date).toISOString().split("T")[0],notes:""}),P={prNumber:[{required:!0,message:k("rfq.pr.prNumberRequired"),trigger:"blur"}],prDate:[{required:!0,message:k("rfq.pr.prDateRequired"),trigger:"change"}]};function Q(e,r="CNY"){return null==e?"-":`${e.toFixed(2)} ${r}`}async function T(){if(I.value)try{await I.value.validate(),await D.confirm(k("rfq.pr.confirmSubmit",{prNumber:F.prNumber}),k("common.confirm"),{confirmButtonText:k("common.confirm"),cancelButtonText:k("common.cancel"),type:"warning"}),C.value=!0,await v(R.rfqId,{prNumber:F.prNumber,prDate:F.prDate,notes:F.notes}),D.success(k("rfq.pr.submitSuccess")),S("submitted")}catch(e){"cancel"!==e&&D.error(e?.message||k("rfq.pr.submitError"))}finally{C.value=!1}}function A(){S("cancel")}return(r,t)=>{const a=j,d=y,v=h,x=_,D=p,R=g,S=c,V=q,B=b;return f(),l("div",N,[o(B,null,{header:s(()=>[u("h3",null,n(i(k)("rfq.pr.fillPR")),1)]),default:s(()=>[o(a,{title:i(k)("rfq.pr.instruction"),type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"24px"}},null,8,["title"]),o(x,{column:2,border:"",style:{"margin-bottom":"24px"}},{default:s(()=>[o(d,{label:i(k)("rfq.form.title")},{default:s(()=>[m(n(e.rfq?.title),1)]),_:1},8,["label"]),o(d,{label:i(k)("rfq.approval.selectedSupplier")},{default:s(()=>[m(n(e.selectedQuote?.supplierName),1)]),_:1},8,["label"]),o(d,{label:i(k)("rfq.quote.grandTotal")},{default:s(()=>[u("span",w,n(Q(e.selectedQuote?.totalAmount,e.selectedQuote?.currency)),1)]),_:1},8,["label"]),o(d,{label:i(k)("rfq.pr.approvalStatus")},{default:s(()=>[o(v,{type:"success"},{default:s(()=>[m(n(i(k)("rfq.approval.status.approved")),1)]),_:1})]),_:1},8,["label"])]),_:1}),o(V,{ref_key:"formRef",ref:I,model:F,rules:P,"label-position":"top"},{default:s(()=>[o(R,{label:i(k)("rfq.pr.notes")},{default:s(()=>[o(D,{modelValue:F.notes,"onUpdate:modelValue":t[0]||(t[0]=e=>F.notes=e),type:"textarea",rows:4,placeholder:i(k)("rfq.pr.notesPlaceholder"),maxlength:"500","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u("div",E,[o(S,{onClick:A},{default:s(()=>[m(n(i(k)("common.cancel")),1)]),_:1}),o(S,{type:"primary",loading:C.value,onClick:T},{default:s(()=>[m(n(i(k)("rfq.pr.submitPR")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})])}}}),[["__scopeId","data-v-c77648f2"]]);export{D as default};
