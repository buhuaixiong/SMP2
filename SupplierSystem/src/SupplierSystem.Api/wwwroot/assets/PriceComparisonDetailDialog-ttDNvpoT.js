import{d as a,u as e,h as i,B as r,c as l,z as t,k as o,b as p,y as s,e as c,t as d,f as n,j as m,O as f,cF as u,x as g,aI as D,F as P,A as v,cI as C,H as b,o as q,_ as h}from"./index-CA1ThEvj.js";import{E as _}from"./el-alert-VmMlafpt.js";import{a as y,E as k}from"./el-table-column-CkSadyqs.js";import"./el-scrollbar-DefzV4pD.js";import{E as w}from"./el-tag-CxTn4T_Z.js";import{E as x,a as j}from"./el-descriptions-item-Dhl6RC2O.js";import{E as F}from"./el-image-viewer-CKYUvYEK.js";const U={key:0,class:"comparison-detail"},E={class:"screenshot-section"},I={class:"screenshot-preview"},N={class:"image-error"},B={key:1,class:"no-image"},M={class:"info-section"},z={class:"price-value"},V=["href"],A={key:1},L={key:0,class:"supplier-prices-section"},S={class:"price-value"},H={key:1,class:"analysis-section"},O=h(a({__name:"PriceComparisonDetailDialog",props:{visible:{type:Boolean},detailData:{},supplierPrices:{}},emits:["update:visible","download"],setup(a,{emit:h}){const O=a,T=h,{t:W}=e(),Y=i(O.visible);r(()=>O.visible,a=>{Y.value=a}),r(Y,a=>{T("update:visible",a)});const G=l(()=>O.detailData?W("rfq.priceComparison.dialog.title",{item:O.detailData.lineItemNumber||"",platform:J.value}):""),J=l(()=>{if(!O.detailData)return"";const a=O.detailData.platform;return{1688:"1688",jd:W("rfq.priceComparison.platforms.jd"),zkh:W("rfq.priceComparison.platforms.zkh")}[a]||a}),K=l(()=>{if(!O.supplierPrices||!O.detailData?.platformPrice)return"info";const a=Math.min(...O.supplierPrices.map(a=>a.price));return a<O.detailData.platformPrice?"success":a>O.detailData.platformPrice?"warning":"info"}),Q=l(()=>{if(!O.supplierPrices||!O.detailData?.platformPrice)return"";const a=Math.min(...O.supplierPrices.map(a=>a.price)),e=O.supplierPrices.find(e=>e.price===a);if(a<O.detailData.platformPrice){const i=((O.detailData.platformPrice-a)/O.detailData.platformPrice*100).toFixed(1);return W("rfq.priceComparison.dialog.supplierBetter",{supplier:e?.supplierName,percent:i})}if(a>O.detailData.platformPrice){const e=((a-O.detailData.platformPrice)/O.detailData.platformPrice*100).toFixed(1);return W("rfq.priceComparison.dialog.marketBetter",{percent:e})}return W("rfq.priceComparison.dialog.pricesEqual")}),R=l(()=>{if(!O.supplierPrices||!O.detailData?.platformPrice)return"";const a=Math.min(...O.supplierPrices.map(a=>a.price));return a<O.detailData.platformPrice?W("rfq.priceComparison.dialog.recommendSupplier"):a>O.detailData.platformPrice?W("rfq.priceComparison.dialog.considerMarket"):""});function X(a){if(!a)return"-";try{return new Date(a).toLocaleString()}catch{return a}}function Z(){Y.value=!1}function $(){T("download",O.detailData)}return(e,i)=>{const r=f,l=F,h=j,O=x,T=k,aa=w,ea=y,ia=_,ra=v,la=b;return q(),t(la,{modelValue:Y.value,"onUpdate:modelValue":i[0]||(i[0]=a=>Y.value=a),title:G.value,width:"900px",onClose:Z},{footer:o(()=>[a.detailData?.downloadUrl?(q(),t(ra,{key:0,onClick:$},{default:o(()=>[m(r,null,{default:o(()=>[m(n(C))]),_:1}),g(" "+d(n(W)("rfq.priceComparison.dialog.download")),1)]),_:1})):s("",!0),m(ra,{type:"primary",onClick:Z},{default:o(()=>[g(d(n(W)("common.close")),1)]),_:1})]),default:o(()=>[a.detailData?(q(),p("div",U,[c("div",E,[c("h4",null,d(n(W)("rfq.priceComparison.dialog.screenshot")),1),c("div",I,[a.detailData.downloadUrl?(q(),t(l,{key:0,src:a.detailData.downloadUrl,"preview-src-list":[a.detailData.downloadUrl],fit:"contain",style:{width:"100%","max-height":"400px"}},{error:o(()=>[c("div",N,[m(r,null,{default:o(()=>[m(n(u))]),_:1}),c("span",null,d(n(W)("rfq.priceComparison.dialog.imageLoadFailed")),1)])]),_:1},8,["src","preview-src-list"])):(q(),p("div",B,d(n(W)("rfq.priceComparison.dialog.noImage")),1))])]),c("div",M,[c("h4",null,d(n(W)("rfq.priceComparison.dialog.platformInfo")),1),m(O,{column:2,border:""},{default:o(()=>[m(h,{label:n(W)("rfq.priceComparison.dialog.platform")},{default:o(()=>[g(d(J.value),1)]),_:1},8,["label"]),m(h,{label:n(W)("rfq.priceComparison.dialog.price")},{default:o(()=>[c("span",z,"¥"+d(a.detailData.platformPrice?.toFixed(2)||"-"),1)]),_:1},8,["label"]),m(h,{label:n(W)("rfq.priceComparison.dialog.productUrl"),span:2},{default:o(()=>[a.detailData.productUrl?(q(),p("a",{key:0,href:a.detailData.productUrl,target:"_blank",class:"product-link"},[g(d(a.detailData.productUrl)+" ",1),m(r,null,{default:o(()=>[m(n(D))]),_:1})],8,V)):(q(),p("span",A,"-"))]),_:1},8,["label"]),m(h,{label:n(W)("rfq.priceComparison.dialog.uploadTime")},{default:o(()=>[g(d(X(a.detailData.uploadedAt)),1)]),_:1},8,["label"]),m(h,{label:n(W)("rfq.priceComparison.dialog.fileName")},{default:o(()=>[g(d(a.detailData.originalFileName||a.detailData.original_file_name||"-"),1)]),_:1},8,["label"])]),_:1})]),a.supplierPrices&&a.supplierPrices.length>0?(q(),p("div",L,[c("h4",null,d(n(W)("rfq.priceComparison.dialog.supplierPrices")),1),m(ea,{data:a.supplierPrices,border:""},{default:o(()=>[m(T,{label:n(W)("rfq.priceComparison.dialog.supplier"),prop:"supplierName"},null,8,["label"]),m(T,{label:n(W)("rfq.priceComparison.dialog.price"),align:"right"},{default:o(({row:a})=>[c("span",S,"¥"+d(a.price?.toFixed(4)),1)]),_:1},8,["label"]),m(T,{label:n(W)("rfq.priceComparison.dialog.comparison"),align:"center"},{default:o(({row:e})=>[a.detailData.platformPrice?(q(),p(P,{key:0},[e.price<a.detailData.platformPrice?(q(),t(aa,{key:0,type:"success"},{default:o(()=>[g(d(n(W)("rfq.priceComparison.dialog.lower"))+" "+d(((a.detailData.platformPrice-e.price)/a.detailData.platformPrice*100).toFixed(1))+"% ",1)]),_:2},1024)):e.price>a.detailData.platformPrice?(q(),t(aa,{key:1,type:"danger"},{default:o(()=>[g(d(n(W)("rfq.priceComparison.dialog.higher"))+" "+d(((e.price-a.detailData.platformPrice)/a.detailData.platformPrice*100).toFixed(1))+"% ",1)]),_:2},1024)):(q(),t(aa,{key:2,type:"info"},{default:o(()=>[g(d(n(W)("rfq.priceComparison.dialog.equal")),1)]),_:1}))],64)):s("",!0)]),_:1},8,["label"])]),_:1},8,["data"])])):s("",!0),a.supplierPrices&&a.supplierPrices.length>0&&a.detailData.platformPrice?(q(),p("div",H,[c("h4",null,d(n(W)("rfq.priceComparison.dialog.analysis")),1),m(ia,{title:Q.value,type:K.value,description:R.value,"show-icon":"",closable:!1},null,8,["title","type","description"])])):s("",!0)])):s("",!0)]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-37c4cf19"]]);export{O as P};
