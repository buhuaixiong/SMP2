import{d as a,u as e,h as i,B as r,c as l,z as t,k as o,b as p,y as s,e as c,t as d,f as n,j as m,O as f,cE as u,x as g,aI as D,F as P,A as v,cH as C,H as b,o as q,_}from"./index-CyQdnTIC.js";import{E as h}from"./el-alert-BXhB-eTB.js";import{a as y,E as k}from"./el-table-column-DvsfEAIW.js";import"./el-scrollbar-CTtrnhms.js";import{E as w}from"./el-tag-eQgnjs1v.js";import{E as x,a as j}from"./el-descriptions-item-C3lsVx1m.js";import{E as F}from"./el-image-viewer-Ob_QgRYt.js";const U={key:0,class:"comparison-detail"},E={class:"screenshot-section"},I={class:"screenshot-preview"},N={class:"image-error"},B={key:1,class:"no-image"},M={class:"info-section"},z={class:"price-value"},V=["href"],A={key:1},H={key:0,class:"supplier-prices-section"},L={class:"price-value"},S={key:1,class:"analysis-section"},T=_(a({__name:"PriceComparisonDetailDialog",props:{visible:{type:Boolean},detailData:{},supplierPrices:{}},emits:["update:visible","download"],setup(a,{emit:_}){const T=a,O=_,{t:G}=e(),J=i(T.visible);r(()=>T.visible,a=>{J.value=a}),r(J,a=>{O("update:visible",a)});const K=l(()=>T.detailData?G("rfq.priceComparison.dialog.title",{item:T.detailData.lineItemNumber||"",platform:Q.value}):""),Q=l(()=>{if(!T.detailData)return"";const a=T.detailData.platform;return{1688:"1688",jd:G("rfq.priceComparison.platforms.jd"),zkh:G("rfq.priceComparison.platforms.zkh")}[a]||a}),R=l(()=>{if(!T.supplierPrices||!T.detailData?.platformPrice)return"info";const a=Math.min(...T.supplierPrices.map(a=>a.price));return a<T.detailData.platformPrice?"success":a>T.detailData.platformPrice?"warning":"info"}),W=l(()=>{if(!T.supplierPrices||!T.detailData?.platformPrice)return"";const a=Math.min(...T.supplierPrices.map(a=>a.price)),e=T.supplierPrices.find(e=>e.price===a);if(a<T.detailData.platformPrice){const i=((T.detailData.platformPrice-a)/T.detailData.platformPrice*100).toFixed(1);return G("rfq.priceComparison.dialog.supplierBetter",{supplier:e?.supplierName,percent:i})}if(a>T.detailData.platformPrice){const e=((a-T.detailData.platformPrice)/T.detailData.platformPrice*100).toFixed(1);return G("rfq.priceComparison.dialog.marketBetter",{percent:e})}return G("rfq.priceComparison.dialog.pricesEqual")}),X=l(()=>{if(!T.supplierPrices||!T.detailData?.platformPrice)return"";const a=Math.min(...T.supplierPrices.map(a=>a.price));return a<T.detailData.platformPrice?G("rfq.priceComparison.dialog.recommendSupplier"):a>T.detailData.platformPrice?G("rfq.priceComparison.dialog.considerMarket"):""});function Y(a){if(!a)return"-";try{return new Date(a).toLocaleString()}catch{return a}}function Z(){J.value=!1}function $(){O("download",T.detailData)}return(e,i)=>{const r=f,l=F,_=j,T=x,O=k,aa=w,ea=y,ia=h,ra=v,la=b;return q(),t(la,{modelValue:J.value,"onUpdate:modelValue":i[0]||(i[0]=a=>J.value=a),title:K.value,width:"900px",onClose:Z},{footer:o(()=>[a.detailData?.downloadUrl?(q(),t(ra,{key:0,onClick:$},{default:o(()=>[m(r,null,{default:o(()=>[m(n(C))]),_:1}),g(" "+d(n(G)("rfq.priceComparison.dialog.download")),1)]),_:1})):s("",!0),m(ra,{type:"primary",onClick:Z},{default:o(()=>[g(d(n(G)("common.close")),1)]),_:1})]),default:o(()=>[a.detailData?(q(),p("div",U,[c("div",E,[c("h4",null,d(n(G)("rfq.priceComparison.dialog.screenshot")),1),c("div",I,[a.detailData.downloadUrl?(q(),t(l,{key:0,src:a.detailData.downloadUrl,"preview-src-list":[a.detailData.downloadUrl],fit:"contain",style:{width:"100%","max-height":"400px"}},{error:o(()=>[c("div",N,[m(r,null,{default:o(()=>[m(n(u))]),_:1}),c("span",null,d(n(G)("rfq.priceComparison.dialog.imageLoadFailed")),1)])]),_:1},8,["src","preview-src-list"])):(q(),p("div",B,d(n(G)("rfq.priceComparison.dialog.noImage")),1))])]),c("div",M,[c("h4",null,d(n(G)("rfq.priceComparison.dialog.platformInfo")),1),m(T,{column:2,border:""},{default:o(()=>[m(_,{label:n(G)("rfq.priceComparison.dialog.platform")},{default:o(()=>[g(d(Q.value),1)]),_:1},8,["label"]),m(_,{label:n(G)("rfq.priceComparison.dialog.price")},{default:o(()=>[c("span",z,"¥"+d(a.detailData.platformPrice?.toFixed(2)||"-"),1)]),_:1},8,["label"]),m(_,{label:n(G)("rfq.priceComparison.dialog.productUrl"),span:2},{default:o(()=>[a.detailData.productUrl?(q(),p("a",{key:0,href:a.detailData.productUrl,target:"_blank",class:"product-link"},[g(d(a.detailData.productUrl)+" ",1),m(r,null,{default:o(()=>[m(n(D))]),_:1})],8,V)):(q(),p("span",A,"-"))]),_:1},8,["label"]),m(_,{label:n(G)("rfq.priceComparison.dialog.uploadTime")},{default:o(()=>[g(d(Y(a.detailData.uploadedAt)),1)]),_:1},8,["label"]),m(_,{label:n(G)("rfq.priceComparison.dialog.fileName")},{default:o(()=>[g(d(a.detailData.originalFileName||a.detailData.original_file_name||"-"),1)]),_:1},8,["label"])]),_:1})]),a.supplierPrices&&a.supplierPrices.length>0?(q(),p("div",H,[c("h4",null,d(n(G)("rfq.priceComparison.dialog.supplierPrices")),1),m(ea,{data:a.supplierPrices,border:""},{default:o(()=>[m(O,{label:n(G)("rfq.priceComparison.dialog.supplier"),prop:"supplierName"},null,8,["label"]),m(O,{label:n(G)("rfq.priceComparison.dialog.price"),align:"right"},{default:o(({row:a})=>[c("span",L,"¥"+d(a.price?.toFixed(4)),1)]),_:1},8,["label"]),m(O,{label:n(G)("rfq.priceComparison.dialog.comparison"),align:"center"},{default:o(({row:e})=>[a.detailData.platformPrice?(q(),p(P,{key:0},[e.price<a.detailData.platformPrice?(q(),t(aa,{key:0,type:"success"},{default:o(()=>[g(d(n(G)("rfq.priceComparison.dialog.lower"))+" "+d(((a.detailData.platformPrice-e.price)/a.detailData.platformPrice*100).toFixed(1))+"% ",1)]),_:2},1024)):e.price>a.detailData.platformPrice?(q(),t(aa,{key:1,type:"danger"},{default:o(()=>[g(d(n(G)("rfq.priceComparison.dialog.higher"))+" "+d(((e.price-a.detailData.platformPrice)/a.detailData.platformPrice*100).toFixed(1))+"% ",1)]),_:2},1024)):(q(),t(aa,{key:2,type:"info"},{default:o(()=>[g(d(n(G)("rfq.priceComparison.dialog.equal")),1)]),_:1}))],64)):s("",!0)]),_:1},8,["label"])]),_:1},8,["data"])])):s("",!0),a.supplierPrices&&a.supplierPrices.length>0&&a.detailData.platformPrice?(q(),p("div",S,[c("h4",null,d(n(G)("rfq.priceComparison.dialog.analysis")),1),m(ia,{title:W.value,type:R.value,description:X.value,"show-icon":"",closable:!1},null,8,["title","type","description"])])):s("",!0)])):s("",!0)]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-37c4cf19"]]);export{T as P};
