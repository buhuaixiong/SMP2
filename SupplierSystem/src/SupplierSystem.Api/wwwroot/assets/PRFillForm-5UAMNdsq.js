import{d as e,u as r,h as t,i as a,b as l,j as o,k as s,f as i,x as m,t as n,e as u,E as p,A as c,o as f,_ as d}from"./index-DISlOFqe.js";import{E as b}from"./el-card-CGz5VnDQ.js";import{E as q,a as g}from"./el-form-item-Tw5nQCrq.js";/* empty css                 */import{E as _,a as h}from"./el-descriptions-item-DLQW7qVK.js";import{E as y}from"./el-tag-ByABDJ4J.js";import{E as v}from"./el-alert-e90EzAct.js";import{o as j}from"./rfq-onvJUTCX.js";import{u as N}from"./useNotification-CHtLFBIz.js";import"./castArray-azK818tA.js";import"./_baseClone-GIJOmo0V.js";const x={class:"pr-fill-form"},w={class:"highlight-amount"},E={class:"form-actions"},D=d(e({__name:"PRFillForm",props:{rfqId:{},rfq:{},selectedQuote:{}},emits:["submitted","cancel"],setup(e,{emit:d}){const D=N(),R=e,S=d,{t:k}=r(),C=t(),I=t(!1);t([]);const P=a({prNumber:"",prDate:(new Date).toISOString().split("T")[0],notes:""}),Q={prNumber:[{required:!0,message:k("rfq.pr.prNumberRequired"),trigger:"blur"}],prDate:[{required:!0,message:k("rfq.pr.prDateRequired"),trigger:"change"}]};function T(e,r="CNY"){return null==e?"-":`${e.toFixed(2)} ${r}`}async function A(){if(C.value)try{await C.value.validate(),await D.confirm(k("rfq.pr.confirmSubmit",{prNumber:P.prNumber}),k("common.confirm"),{confirmButtonText:k("common.confirm"),cancelButtonText:k("common.cancel"),type:"warning"}),I.value=!0,await j(R.rfqId,{prNumber:P.prNumber,prDate:P.prDate,notes:P.notes}),D.success(k("rfq.pr.submitSuccess")),S("submitted")}catch(e){"cancel"!==e&&D.error(e?.message||k("rfq.pr.submitError"))}finally{I.value=!1}}function F(){S("cancel")}return(r,t)=>{const a=v,d=h,j=y,N=_,D=p,R=g,S=c,V=q,B=b;return f(),l("div",x,[o(B,null,{header:s(()=>[u("h3",null,n(i(k)("rfq.pr.fillPR")),1)]),default:s(()=>[o(a,{title:i(k)("rfq.pr.instruction"),type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"24px"}},null,8,["title"]),o(N,{column:2,border:"",style:{"margin-bottom":"24px"}},{default:s(()=>[o(d,{label:i(k)("rfq.form.title")},{default:s(()=>[m(n(e.rfq?.title),1)]),_:1},8,["label"]),o(d,{label:i(k)("rfq.approval.selectedSupplier")},{default:s(()=>[m(n(e.selectedQuote?.supplierName),1)]),_:1},8,["label"]),o(d,{label:i(k)("rfq.quote.grandTotal")},{default:s(()=>[u("span",w,n(T(e.selectedQuote?.totalAmount,e.selectedQuote?.currency)),1)]),_:1},8,["label"]),o(d,{label:i(k)("rfq.pr.approvalStatus")},{default:s(()=>[o(j,{type:"success"},{default:s(()=>[m(n(i(k)("rfq.approval.status.approved")),1)]),_:1})]),_:1},8,["label"])]),_:1}),o(V,{ref_key:"formRef",ref:C,model:P,rules:Q,"label-position":"top"},{default:s(()=>[o(R,{label:i(k)("rfq.pr.notes")},{default:s(()=>[o(D,{modelValue:P.notes,"onUpdate:modelValue":t[0]||(t[0]=e=>P.notes=e),type:"textarea",rows:4,placeholder:i(k)("rfq.pr.notesPlaceholder"),maxlength:"500","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u("div",E,[o(S,{onClick:F},{default:s(()=>[m(n(i(k)("common.cancel")),1)]),_:1}),o(S,{type:"primary",loading:I.value,onClick:A},{default:s(()=>[m(n(i(k)("rfq.pr.submitPR")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})])}}}),[["__scopeId","data-v-c77648f2"]]);export{D as default};
