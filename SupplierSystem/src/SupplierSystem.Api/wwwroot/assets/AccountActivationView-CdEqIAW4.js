import{d as a,u as e,h as s,c as l,s as o,C as t,b as i,e as r,z as u,j as n,y as c,k as v,O as d,t as p,f as m,w as f,P as w,Q as b,x as h,A as k,E as g,R as y,S as _,q as P,o as j,_ as V}from"./index-CyQdnTIC.js";import{E as z,a as q}from"./el-form-item-DJ87vTOW.js";import{E}from"./el-alert-BXhB-eTB.js";/* empty css                 */import{E as x}from"./el-result-0g-eS_qh.js";import{activateSupplierAccount as A}from"./public-CZ38BaZI.js";import{u as R}from"./useNotification-DAUqvaBw.js";import"./castArray-C2ko8TfK.js";import"./_baseClone-CxGxK45k.js";const U={class:"activation-page"},C={class:"activation-container"},L={class:"activation-card"},S={class:"activation-header"},I={key:0,class:"activation-subtitle"},N={key:0,class:"activation-success"},$={class:"success-details"},B={key:0,class:"form-hint"},F={class:"password-requirements"},M=V(a({__name:"AccountActivationView",setup(a){const V=R(),M=o(),O=P(),{t:Q}=e(),T=s(),Z=s(!1),D=s(""),G=s(!1),H=s(null),J=l(()=>M.query.token),K=s({token:"",password:"",confirmPassword:""}),W=l(()=>K.value.password.length>=8),X=l(()=>/[A-Z]/.test(K.value.password)),Y=l(()=>/[a-z]/.test(K.value.password)),aa=l(()=>/\d/.test(K.value.password)),ea=l(()=>/[!@#$%^&*(),.?":{}|<>]/.test(K.value.password)),sa=l(()=>W.value&&X.value&&Y.value&&aa.value&&ea.value),la=l(()=>""!==K.value.token.trim()&&sa.value&&K.value.password===K.value.confirmPassword),oa={token:[{required:!0,message:Q("activation.validation.tokenRequired"),trigger:"blur"}],password:[{validator:(a,e,s)=>{e?sa.value?s():s(new Error(Q("activation.validation.passwordInvalid"))):s(new Error(Q("activation.validation.passwordRequired")))},trigger:"blur"}],confirmPassword:[{validator:(a,e,s)=>{e?e!==K.value.password?s(new Error(Q("activation.validation.passwordMismatch"))):s():s(new Error(Q("activation.validation.confirmPasswordRequired")))},trigger:"blur"}]},ta=async()=>{if(T.value){try{await T.value.validate()}catch{return}Z.value=!0,D.value="";try{const a=await A({token:K.value.token,password:K.value.password});H.value=a,G.value=!0,V.success(Q("activation.success.message"))}catch(a){console.error("Activation failed:",a),D.value=a.message||Q("activation.error.failed")}finally{Z.value=!1}}},ia=()=>{O.push("/login")};return t(()=>{J.value&&(K.value.token=J.value)}),(a,e)=>{const s=d,l=k,o=x,t=g,P=q,V=E,A=z;return j(),i("div",U,[r("div",C,[r("div",L,[r("div",S,[n(s,{class:"activation-icon",size:48},{default:v(()=>[G.value?(j(),u(m(w),{key:0})):(j(),u(m(b),{key:1}))]),_:1}),r("h1",null,p(m(Q)("activation.title")),1),G.value?c("",!0):(j(),i("p",I,p(m(Q)("activation.subtitle")),1))]),G.value?(j(),i("div",N,[n(o,{icon:"success",title:m(Q)("activation.success.title"),"sub-title":m(Q)("activation.success.subtitle")},{extra:v(()=>[r("div",$,[r("p",null,[r("strong",null,p(m(Q)("activation.success.username"))+":",1),h(" "+p(H.value?.username),1)]),r("p",null,[r("strong",null,p(m(Q)("activation.success.role"))+":",1),h(" "+p(m(Q)(`roles.${H.value?.role}`)),1)])]),n(l,{type:"primary",size:"large",onClick:ia},{default:v(()=>[h(p(m(Q)("activation.success.goToLogin")),1)]),_:1})]),_:1},8,["title","sub-title"])])):(j(),u(A,{key:1,ref_key:"formRef",ref:T,model:K.value,rules:oa,"label-position":"top",class:"activation-form",onSubmit:f(ta,["prevent"])},{default:v(()=>[n(P,{label:m(Q)("activation.form.token"),prop:"token"},{default:v(()=>[n(t,{modelValue:K.value.token,"onUpdate:modelValue":e[0]||(e[0]=a=>K.value.token=a),placeholder:m(Q)("activation.form.tokenPlaceholder"),disabled:!!J.value,size:"large"},{prefix:v(()=>[n(s,null,{default:v(()=>[n(m(b))]),_:1})]),_:1},8,["modelValue","placeholder","disabled"]),J.value?(j(),i("div",B,p(m(Q)("activation.form.tokenFromUrl")),1)):c("",!0)]),_:1},8,["label"]),n(P,{label:m(Q)("activation.form.password"),prop:"password"},{default:v(()=>[n(t,{modelValue:K.value.password,"onUpdate:modelValue":e[1]||(e[1]=a=>K.value.password=a),type:"password",placeholder:m(Q)("activation.form.passwordPlaceholder"),size:"large","show-password":""},{prefix:v(()=>[n(s,null,{default:v(()=>[n(m(y))]),_:1})]),_:1},8,["modelValue","placeholder"]),r("div",F,[r("p",null,p(m(Q)("activation.form.passwordRequirements")),1),r("ul",null,[r("li",{class:_({valid:W.value})},p(m(Q)("activation.form.minLength")),3),r("li",{class:_({valid:X.value})},p(m(Q)("activation.form.hasUppercase")),3),r("li",{class:_({valid:Y.value})},p(m(Q)("activation.form.hasLowercase")),3),r("li",{class:_({valid:aa.value})},p(m(Q)("activation.form.hasNumber")),3),r("li",{class:_({valid:ea.value})},p(m(Q)("activation.form.hasSpecialChar")),3)])])]),_:1},8,["label"]),n(P,{label:m(Q)("activation.form.confirmPassword"),prop:"confirmPassword"},{default:v(()=>[n(t,{modelValue:K.value.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>K.value.confirmPassword=a),type:"password",placeholder:m(Q)("activation.form.confirmPasswordPlaceholder"),size:"large","show-password":""},{prefix:v(()=>[n(s,null,{default:v(()=>[n(m(y))]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),D.value?(j(),u(V,{key:0,title:D.value,type:"error",closable:!1,"show-icon":"",class:"activation-error"},null,8,["title"])):c("",!0),n(l,{type:"primary",size:"large",loading:Z.value,disabled:!la.value,"native-type":"submit",class:"activation-submit"},{default:v(()=>[h(p(m(Q)("activation.form.submit")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["model"]))])])])}}}),[["__scopeId","data-v-a6d70021"]]);export{M as default};
