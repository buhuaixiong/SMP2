import{d as a,g as e,h as s,C as t,s as o,q as r,T as u,b as i,e as l,j as n,k as c,O as d,t as g,f as p,U as v,o as f,_ as m}from"./index-BvBqerML.js";import{u as h}from"./useNotification-kSmgsM5O.js";const y={class:"auto-login-page"},_={class:"login-box"},b=m(a({__name:"AutoLoginView",setup(a){const m=h(),b=o(),k=r(),q=e(),T=s("正在自动登录..."),j=s("请稍候，即将跳转");return t(async()=>{const a=b.query.token,e=b.query.redirect;if(!a)return m.error("缺少登录凭证"),void k.push("/login");try{T.value="验证邀请链接...";const s=await u.get(`/api/public/auto-login/${a}`);s.data.success&&(T.value="登录成功！",j.value="正在跳转到询价详情页...",localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user)),await q.fetchMe(),setTimeout(()=>{const a=e||s.data.redirectTo||"/dashboard";k.push(a),m.success("欢迎回来！")},800))}catch(s){console.error("[AutoLogin] Error:",s),T.value="登录失败",j.value=s.response?.data?.message||"自动登录失败，请手动登录",m.error(j.value),setTimeout(()=>{k.push({path:"/login",query:{redirect:e}})},2e3)}}),(a,e)=>{const s=d;return f(),i("div",y,[l("div",_,[n(s,{class:"is-loading",size:60,color:"#409eff"},{default:c(()=>[n(p(v))]),_:1}),l("h2",null,g(T.value),1),l("p",null,g(j.value),1)])])}}}),[["__scopeId","data-v-613abcea"]]);export{b as default};
