import{d as a,u as e,h as s,c as l,s as o,C as t,b as i,e as r,z as u,j as n,y as c,k as v,O as d,t as p,f as m,w as f,P as w,Q as b,x as h,A as g,E as k,R as y,S as _,q as P,o as j,_ as V}from"./index-DnnhknrJ.js";import{E as q,a as z}from"./el-form-item-BMvGJGtj.js";import{E}from"./el-alert-DN9tPhGw.js";/* empty css                 */import{E as x}from"./el-result-SMk9S0Ve.js";import{activateSupplierAccount as A}from"./public-CxFXxIQd.js";import{u as R}from"./useNotification-DqDxnuQz.js";import"./castArray-C1iGC4MG.js";import"./_baseClone-DYE-rvD4.js";const U={class:"activation-page"},C={class:"activation-container"},L={class:"activation-card"},N={class:"activation-header"},S={key:0,class:"activation-subtitle"},I={key:0,class:"activation-success"},O={class:"success-details"},Z={key:0,class:"form-hint"},$={class:"password-requirements"},F=V(a({__name:"AccountActivationView",setup(a){const V=R(),F=o(),M=P(),{t:Q}=e(),T=s(),W=s(!1),Y=s(""),B=s(!1),D=s(null),G=l(()=>F.query.token),H=s({token:"",password:"",confirmPassword:""}),J=l(()=>H.value.password.length>=8),K=l(()=>/[A-Z]/.test(H.value.password)),X=l(()=>/[a-z]/.test(H.value.password)),aa=l(()=>/\d/.test(H.value.password)),ea=l(()=>/[!@#$%^&*(),.?":{}|<>]/.test(H.value.password)),sa=l(()=>J.value&&K.value&&X.value&&aa.value&&ea.value),la=l(()=>""!==H.value.token.trim()&&sa.value&&H.value.password===H.value.confirmPassword),oa={token:[{required:!0,message:Q("activation.validation.tokenRequired"),trigger:"blur"}],password:[{validator:(a,e,s)=>{e?sa.value?s():s(new Error(Q("activation.validation.passwordInvalid"))):s(new Error(Q("activation.validation.passwordRequired")))},trigger:"blur"}],confirmPassword:[{validator:(a,e,s)=>{e?e!==H.value.password?s(new Error(Q("activation.validation.passwordMismatch"))):s():s(new Error(Q("activation.validation.confirmPasswordRequired")))},trigger:"blur"}]},ta=async()=>{if(T.value){try{await T.value.validate()}catch{return}W.value=!0,Y.value="";try{const a=await A({token:H.value.token,password:H.value.password});D.value=a,B.value=!0,V.success(Q("activation.success.message"))}catch(a){console.error("Activation failed:",a),Y.value=a.message||Q("activation.error.failed")}finally{W.value=!1}}},ia=()=>{M.push("/login")};return t(()=>{G.value&&(H.value.token=G.value)}),(a,e)=>{const s=d,l=g,o=x,t=k,P=z,V=E,A=q;return j(),i("div",U,[r("div",C,[r("div",L,[r("div",N,[n(s,{class:"activation-icon",size:48},{default:v(()=>[B.value?(j(),u(m(w),{key:0})):(j(),u(m(b),{key:1}))]),_:1}),r("h1",null,p(m(Q)("activation.title")),1),B.value?c("",!0):(j(),i("p",S,p(m(Q)("activation.subtitle")),1))]),B.value?(j(),i("div",I,[n(o,{icon:"success",title:m(Q)("activation.success.title"),"sub-title":m(Q)("activation.success.subtitle")},{extra:v(()=>[r("div",O,[r("p",null,[r("strong",null,p(m(Q)("activation.success.username"))+":",1),h(" "+p(D.value?.username),1)]),r("p",null,[r("strong",null,p(m(Q)("activation.success.role"))+":",1),h(" "+p(m(Q)(`roles.${D.value?.role}`)),1)])]),n(l,{type:"primary",size:"large",onClick:ia},{default:v(()=>[h(p(m(Q)("activation.success.goToLogin")),1)]),_:1})]),_:1},8,["title","sub-title"])])):(j(),u(A,{key:1,ref_key:"formRef",ref:T,model:H.value,rules:oa,"label-position":"top",class:"activation-form",onSubmit:f(ta,["prevent"])},{default:v(()=>[n(P,{label:m(Q)("activation.form.token"),prop:"token"},{default:v(()=>[n(t,{modelValue:H.value.token,"onUpdate:modelValue":e[0]||(e[0]=a=>H.value.token=a),placeholder:m(Q)("activation.form.tokenPlaceholder"),disabled:!!G.value,size:"large"},{prefix:v(()=>[n(s,null,{default:v(()=>[n(m(b))]),_:1})]),_:1},8,["modelValue","placeholder","disabled"]),G.value?(j(),i("div",Z,p(m(Q)("activation.form.tokenFromUrl")),1)):c("",!0)]),_:1},8,["label"]),n(P,{label:m(Q)("activation.form.password"),prop:"password"},{default:v(()=>[n(t,{modelValue:H.value.password,"onUpdate:modelValue":e[1]||(e[1]=a=>H.value.password=a),type:"password",placeholder:m(Q)("activation.form.passwordPlaceholder"),size:"large","show-password":""},{prefix:v(()=>[n(s,null,{default:v(()=>[n(m(y))]),_:1})]),_:1},8,["modelValue","placeholder"]),r("div",$,[r("p",null,p(m(Q)("activation.form.passwordRequirements")),1),r("ul",null,[r("li",{class:_({valid:J.value})},p(m(Q)("activation.form.minLength")),3),r("li",{class:_({valid:K.value})},p(m(Q)("activation.form.hasUppercase")),3),r("li",{class:_({valid:X.value})},p(m(Q)("activation.form.hasLowercase")),3),r("li",{class:_({valid:aa.value})},p(m(Q)("activation.form.hasNumber")),3),r("li",{class:_({valid:ea.value})},p(m(Q)("activation.form.hasSpecialChar")),3)])])]),_:1},8,["label"]),n(P,{label:m(Q)("activation.form.confirmPassword"),prop:"confirmPassword"},{default:v(()=>[n(t,{modelValue:H.value.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>H.value.confirmPassword=a),type:"password",placeholder:m(Q)("activation.form.confirmPasswordPlaceholder"),size:"large","show-password":""},{prefix:v(()=>[n(s,null,{default:v(()=>[n(m(y))]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),Y.value?(j(),u(V,{key:0,title:Y.value,type:"error",closable:!1,"show-icon":"",class:"activation-error"},null,8,["title"])):c("",!0),n(l,{type:"primary",size:"large",loading:W.value,disabled:!la.value,"native-type":"submit",class:"activation-submit"},{default:v(()=>[h(p(m(Q)("activation.form.submit")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["model"]))])])])}}}),[["__scopeId","data-v-a6d70021"]]);export{F as default};
